window.onload=async function(){const e=document.getElementById("email"),t=document.getElementById("consent_check"),n=document.getElementById("submit"),o=document.getElementById("errorMsg"),a=[0,35,367,423,1186,2565,4845],{total_co2:r,green_step:c}=await(async()=>{const e=await fetch("https://api-co2.cubbit.io/saved"),t=await e.json(),{total_co2:n,green_step:o}=t;return console.log(t),{total_co2:n,green_step:o}})();if(r&&document.querySelectorAll(".total_co2").forEach(((e,t)=>{e.innerHTML=r})),c){document.querySelectorAll(".dot").forEach(((e,t)=>{t<c&&e.classList.add("completed"),t===c&&e.classList.add("load")}));const e=()=>0===c?0:(c+(r-a[c])/(a[c+1]-a[c]))/(a.length-1)*100;document.getElementById("co2_progress_bar").style.width=`calc(${e()}% + 10px)`}Webflow.push((()=>{t.addEventListener("change",(()=>{t.checked?n.disabled=!1:n.disabled=!0})),n.addEventListener("click",(async n=>{if(!t.value)return n.preventDefault(),void(o.innerHTML="Please accept the consent");if(!e.value)return n.preventDefault(),void(o.innerHTML="Please enter your email");const a={email:e.value,amount:1,signup:!0,referral_code:""},r=await fetch("https://api-co2.cubbit.io/save",{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}),c=await r.json();if(!c)throw o.innerHTML="Something went wrong",new Error(r.statusText);if(c?.error)throw o.innerHTML=c.message,new Error(c.error);console.log(c),window.location.href=`/thank-you?referral_code=${c}`}))}))};